{#
 # Archive: Job
 #
 # @package WordPress
 # @subpackage CreatorFund
 #}

{% extends 'index.html.twig' %}

{% block content %}
	<main class="my-10 lg:my-20 space-y-10">

		<div class="container">
			<div class="row">
				<div class="lg:col-6/12">
					<h1 class="text-2xl lg:text-4xl leading-tight font-bold">
						{{- post.title -}}
					</h1>

					{% if post.introduction %}
						<p class="mt-3 lg:mt-4 text-sm lg:text-base font-light opacity-0 has-dom-ready:opacity-100 duration-1000 ease-in-out transition-opacity">
							{{- post.introduction -}}
						</p>
					{% endif %}
				</div>
			</div>
		</div>

		{{- include( 'blocks/blocks.html.twig', { blocks: post.meta( 'blocks' ) } ) -}}

		{% if post.posts.found_posts > 0 %}
			<div
				data-module-load-more-posts
				data-load-more-posts-posts-per-page="12"
				data-load-more-posts-post-type="job"
			>


				<input type="hidden" name="found-posts" value="{{ post.posts.found_posts }}">

				<div class="container space-y-9">

					<div class="row">
						<div class="mb-5">
							<h2 class="text-2xl font-bold">{{- __( 'Explore Jobs', 'creatorfund' ) -}}</h2>
						</div>
						<div>
							{% embed 'components/filters.html.twig' %}
								{% block header %}
									<label class="flex items-center gap-x-3 relative border py-2 px-4 border-theme-black">
										{{- icon( 'magnifying-glass', { classes: [ 'w-6', 'h-6' ] } ) -}}
										<input class="bg-transparent" type="text" name="s" data-load-more-posts="search">
									</label>
								{% endblock %}

								{% block body %}
									{% import 'macros/forms.html.twig' as forms %}

									{{-
										forms.checkboxes(
											{
												attributes: { 'data-load-more-posts': 'filter' },
												classes: [ 'w-24' ],
												name: 'company',
												options: get_terms( { post_type: 'job', taxonomy: 'company', orderby: 'term_order', hide_empty: false } ) | map( term => ( { value: term.term_id, title: term.name } ) ),
												title: __( 'Companies', 'creatorfund' ),
											}
										)
									-}}

									{{-
										forms.checkboxes(
											{
												attributes: { 'data-load-more-posts': 'filter' },
												classes: [ 'w-24' ],
												name: 'job_cat',
												options: get_terms( { post_type: 'job', taxonomy: 'job_cat', orderby: 'term_order', hide_empty: false } ) | map( term => ( { value: term.term_id, title: term.name } ) ),
												title: __( 'Job function', 'creatorfund' ),
											}
										)
									-}}

									{{-
										forms.checkboxes(
											{
												attributes: { 'data-load-more-posts': 'filter' },
												classes: [ 'w-24' ],
												name: 'location',
												options: get_terms( { post_type: 'job', taxonomy: 'location', orderby: 'term_order', hide_empty: false } ) | map( term => ( { value: term.term_id, title: term.name } ) ),
												title: __( 'Location', 'creatorfund' ),
											}
										)
									-}}
								{% endblock %}
							{% endembed %}
						</div>
					</div>

					<div
						data-load-more-posts="counter"
						data-singular="{{- __( 'Showing 1 Job', 'creatorfund' ) -}}"
						data-plural="{{- __( 'Showing %s Jobs', 'creatorfund' ) -}}"
					>
						{% if post.posts.found_posts > 0 %}
							{{- _n( 'Showing %s Job', 'Showing %s Jobs', post.posts.found_posts, 'creatorfund' ) | format( post.posts.found_posts ) -}}
						{% endif %}
					</div>

					<div
						class="row transition-opacity duration-1000 ease-in-out"
						data-load-more-posts="container"
					>


						{{- include( 'components/collection-job.html.twig', { found_posts: post.posts.found_posts, posts: post.posts } ) -}}
					</div>

					<button
							class="button mx-auto"
							type="button"
							data-load-more-posts="button"
							style="display: {{ post.posts.found_posts > 12 ? 'block' : 'none' }}"
						>
						{{- __( 'Load more', 'creatorfund' ) -}}
					</button>
				</div>
			</div>
		{% endif %}

		{% if post.meta( 'notice' ) %}
			{{-
				include(
					'blocks/notice.html.twig',
					{
						block: {
							title: post.meta( 'notice' ).title,
							content: post.meta( 'notice' ).content,
							link: post.meta( 'notice' ).link,
						}
					}
				)
			-}}
		{% endif %}
	</main>


{% endblock %}
